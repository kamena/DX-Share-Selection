window.onload=function(){function getBaseUrl(url){if(-1==url.indexOf(".")||-1==url.indexOf("/"))return!1;var result=url.substr(0,url.indexOf("/",url.indexOf("."))+1);return result}function splitList(){for(listSplit=sts_options.lists.split("|"),i=0;i<listSplit.length;i++)lstSplit[i]=listSplit[i].split(",")}function createListBox(){stsBox_wrap=document.createElement("div"),stsBox_wrap_f=stsBox_wrap.setAttribute("id","stsBox_wrap"),stsBox_wrap.innerHTML='<div id="stsBox_title">'+sts_options.title+'<a href="http://www.aakashweb.com" title="What is this ?" target="_blank" rel="follow">?</a></div><div id="stsBox_list"><ul id="stsBox_ul"></ul></div><span id="stsBox_arrow"></span>',stsBox_wrap.setAttribute("class",sts_options.extraClass),document.body.appendChild(stsBox_wrap)}function addToList(){for(i=0;i<listSplit.length;i++)null!==lstSplit[i][0]&&(null!==lstSplit[i][2]?(iconUrl=lstSplit[i][2].split(" ").join(""),img="favicon"==iconUrl?'<img src="'+getBaseUrl(lstSplit[i][1])+'favicon.ico" width="16" height="16" alt="'+lstSplit[i][0]+'"/> ':'<img src="'+lstSplit[i][2]+'" width="16" height="16" alt="'+lstSplit[i][0]+'"/> '):img="",tempList=img+'<a rel="'+lstSplit[i][1]+'" title="'+lstSplit[i][0]+'" href="#">'+lstSplit[i][0]+"</a>",newList=document.createElement("li"),newList.setAttribute("value",lstSplit[i][1]),newList.innerHTML=tempList,document.getElementById("stsBox_ul").appendChild(newList))}function applyCss(){stsW=document.getElementById("stsBox_wrap"),stsW.style.position="absolute",stsW.style.display="none",stsW.style.margin="0",stsW.style.width="200px",stsW.style.border="5px solid "+sts_options.borderColor,stsW.style.borderRadius="5px",stsW.style.webkitBorderRadius="5px",stsW.style.MozBorderRadius="5px",stsImg=stsW.getElementsByTagName("img");for(var i=0;i<stsImg.length;i++)stsImg[i].style.verticalAlign="middle";stsT=document.getElementById("stsBox_title"),stsT.style.background=sts_options.titleColor,stsT.style.padding="3px",stsT.style.borderBottom="1px solid #e5e5e5",stsT.style.color=sts_options.textColor,stsTa=stsT.getElementsByTagName("a");for(var i=0;i<stsTa.length;i++)stsTa[i].style.float="right",stsTa[i].style.paddingLeft="5px",stsTa[i].style.paddingRight="5px";stsA=stsW.getElementsByTagName("a");for(var i=0;i<stsA.length;i++)stsA[i].style.color=sts_options.textColor,stsA[i].style.textDecoration="none";stsL=document.getElementById("stsBox_list"),stsL.style.background=sts_options.background,stsUl=stsW.getElementsByTagName("ul");for(var i=0;i<stsUl.length;i++)stsUl[i].style.listStyle="none",stsUl[i].style.margin="0px",stsUl[i].style.padding="0px",stsUl[i].style.cursor="pointer";stsLi=stsW.getElementsByTagName("li");for(var i=0;i<stsLi.length;i++)stsLi[i].style.padding="3px",stsLi[i].onmouseover=function(){this.style.background=sts_options.hoverColor},stsLi[i].onmouseout=function(){this.style.background="none"};stsAr=document.getElementById("stsBox_arrow"),stsAr.style.width=0,stsAr.style.height=0,stsAr.style.lineHeight=0,stsAr.style.borderLeft="10px solid transparent",stsAr.style.borderTop="15px solid "+sts_options.borderColor,stsAr.style.position="absolute",stsAr.style.bottom="-19px"}function getSelectionText(){return window.getSelection?selectionTxt=window.getSelection():document.getSelection?selectionTxt=document.getSelection():document.selection&&(selectionTxt=document.selection.createRange().text),cc=selectionTxt,selectionTxt}function getCursorPosition(e){e=e||window.event;var cursor={x:0,y:0};return e.pageX||e.pageY?(cursor.x=e.pageX,cursor.y=e.pageY):(cursor.x=e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft,cursor.y=e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop),cursor}function isBox(elem){return null!=elem&&("stsBox_wrap"===elem.id||isBox(elem.parentNode))}function liOnClick(){Gsts=document.getElementById("stsBox_wrap"),GstsLi=Gsts.getElementsByTagName("li");for(var j=0;j<GstsLi.length;j++)GstsLi[j].onclick=function(){sUrl=this.getAttribute("value"),selectedText=this.getAttribute("sel"),theUrl=sUrl.replace("%s",selectedText),theUrl=theUrl.replace("%ts",selectedText.trunc(sts_options.truncateChars)),window.open(theUrl,"sts_window")}}function init(){splitList(),createListBox(),addToList(),applyCss(),liOnClick()}var sts_options={title:"Use this text ...",lists:"Google,http://www.google.com/search?q=%s",truncateChars:115,extraClass:"",borderColor:"#444",background:"#fff",titleColor:"#f2f2f2",hoverColor:"#ffffcc",textColor:"#000"};if("undefined"!=typeof sts_config)for(var keyDef in sts_options)void 0!==sts_config[keyDef]&&(sts_options[keyDef]=sts_config[keyDef]);var cc,listSplit=[],lstSplit=[];String.prototype.trunc=function(n){return this.substr(0,n-1)+(this.length>n?"...":"")},document.onmouseup=function(e){var e=e||window.event;if(!isBox(e.target||e.srcElement)&&""!=getSelectionText()){cursor=getCursorPosition(e);var x=cursor.x,y=cursor.y;Ests=document.getElementById("stsBox_wrap"),Ests.style.display="block",Ests.style.top=y-(Ests.offsetHeight+30)+"px",Ests.style.left=x-30+"px",EstsLi=Ests.getElementsByTagName("li");for(var i=0;i<EstsLi.length;i++)EstsLi[i].setAttribute("sel",getSelectionText())}},document.onmousedown=function(e){e=e||window.event,isBox(e.target||e.srcElement)||(Fsts=document.getElementById("stsBox_wrap"),Fsts.style.display="none")},init()};